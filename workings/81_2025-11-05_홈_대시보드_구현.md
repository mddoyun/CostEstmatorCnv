# í™ˆ ëŒ€ì‹œë³´ë“œ êµ¬í˜„

**ë‚ ì§œ**: 2025-11-05
**ì‘ì—…ì**: Claude (AI Assistant)

## ê°œìš”

í™ˆ íƒ­ì„ 2-column ë ˆì´ì•„ì›ƒìœ¼ë¡œ ê°œì„ í•˜ê³ , í˜„ì¬ í”„ë¡œì íŠ¸ì˜ ì£¼ìš” í†µê³„ë¥¼ ì‹¤ì‹œê°„ìœ¼ë¡œ í‘œì‹œí•˜ëŠ” ëŒ€ì‹œë³´ë“œë¥¼ êµ¬í˜„í–ˆìŠµë‹ˆë‹¤.

ì‚¬ìš©ìê°€ í”„ë¡œì íŠ¸ë¥¼ ì„ íƒí•˜ë©´ ì™¼ìª½ì—ëŠ” í”„ë¡œì íŠ¸ ê´€ë¦¬ ì˜ì—­, ì˜¤ë¥¸ìª½ì—ëŠ” ì´ ê³µì‚¬ë¹„, ê³µì • ê¸°ê°„ ë“±ì˜ ë°ì´í„°ë¥¼ í‘œì‹œí•˜ëŠ” ëŒ€ì‹œë³´ë“œê°€ ë‚˜íƒ€ë‚©ë‹ˆë‹¤.

## ì£¼ìš” ìˆ˜ì • ì‚¬í•­

### 1. HTML ë ˆì´ì•„ì›ƒ ë³€ê²½ (2-Column êµ¬ì¡°)
**íŒŒì¼**: `connections/templates/revit_control.html`
**ìœ„ì¹˜**: Lines 208-329

**ë³€ê²½ ì‚¬í•­**:
- ê¸°ì¡´ ë‹¨ì¼ ì»¬ëŸ¼ ë ˆì´ì•„ì›ƒì„ 2-column Grid ë ˆì´ì•„ì›ƒìœ¼ë¡œ ë³€ê²½
- ì™¼ìª½ ì»¬ëŸ¼ (400px): í”„ë¡œì íŠ¸ ê´€ë¦¬ ì˜ì—­
  - í”„ë¡œì íŠ¸ ëª©ë¡ (Select ë“œë¡­ë‹¤ìš´)
  - ìƒˆ í”„ë¡œì íŠ¸, ì‚­ì œ, í”„ë¡œì íŠ¸ ê°€ì ¸ì˜¤ê¸° ë²„íŠ¼ (ì„¸ë¡œ ë°°ì¹˜)
- ì˜¤ë¥¸ìª½ ì»¬ëŸ¼ (1fr - ìœ ë™ì ): ëŒ€ì‹œë³´ë“œ ì˜ì—­
  - í”„ë¡œì íŠ¸ ì„ íƒ ì‹œ: ëŒ€ì‹œë³´ë“œ í‘œì‹œ
  - í”„ë¡œì íŠ¸ ë¯¸ì„ íƒ ì‹œ: ì•ˆë‚´ ë©”ì‹œì§€ í‘œì‹œ

**êµ¬í˜„ ì½”ë“œ**:
```html
<!-- 2-Column ë ˆì´ì•„ì›ƒ -->
<div style="display: grid; grid-template-columns: 400px 1fr; gap: 30px; align-items: start;">

    <!-- ì™¼ìª½: í”„ë¡œì íŠ¸ ê´€ë¦¬ ì˜ì—­ (400px) -->
    <div>
        <div style="background: white; border-radius: 8px; padding: 25px;">
            <h2 style="margin-top: 0; margin-bottom: 20px; color: #333;">í”„ë¡œì íŠ¸ ê´€ë¦¬</h2>

            <!-- í”„ë¡œì íŠ¸ ì„ íƒ -->
            <div style="margin-bottom: 15px;">
                <label style="display: block; margin-bottom: 8px; font-weight: 500;">í”„ë¡œì íŠ¸ ì„ íƒ:</label>
                <select id="project-selector" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px;">
                    <option value="">í”„ë¡œì íŠ¸ë¥¼ ì„ íƒí•˜ì„¸ìš”</option>
                </select>
            </div>

            <!-- í”„ë¡œì íŠ¸ ê´€ë¦¬ ë²„íŠ¼ (ì„¸ë¡œ ë°°ì¹˜) -->
            <div style="display: flex; flex-direction: column; gap: 10px;">
                <button id="home-create-project-btn" class="primary-btn">ìƒˆ í”„ë¡œì íŠ¸</button>
                <button id="home-delete-project-btn" class="secondary-btn">í”„ë¡œì íŠ¸ ì‚­ì œ</button>
                <button id="home-import-project-btn" class="secondary-btn">í”„ë¡œì íŠ¸ ê°€ì ¸ì˜¤ê¸°</button>
            </div>
        </div>
    </div>

    <!-- ì˜¤ë¥¸ìª½: ëŒ€ì‹œë³´ë“œ ì˜ì—­ (1fr - flexible) -->
    <div>
        <!-- í”„ë¡œì íŠ¸ ëŒ€ì‹œë³´ë“œ -->
        <div id="home-dashboard" style="display: none; background: white; border-radius: 8px; padding: 25px;">
            <h2 style="margin-top: 0; margin-bottom: 20px; color: #333;">ğŸ“Š í”„ë¡œì íŠ¸ ëŒ€ì‹œë³´ë“œ</h2>

            <!-- 2x2 Grid of cards -->
            <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px; margin-top: 20px;">

                <!-- ìƒì„¸ë‚´ì—­ì„œ ì¹´ë“œ (with data) -->
                <div class="quick-action-card" data-target-tab="detailed-estimation-dd" style="cursor: pointer;">
                    <div class="card-icon">ğŸ“‹</div>
                    <h3>ìƒì„¸ë‚´ì—­ì„œ ë³´ê¸°</h3>
                    <div style="font-size: 24px; font-weight: bold; color: #2196F3; margin: 10px 0;">
                        <span id="dashboard-total-cost">-</span>
                    </div>
                    <p style="margin: 5px 0; color: #666; font-size: 14px;">ì´ ê³µì‚¬ë¹„</p>
                </div>

                <!-- ê³µì •ê³„íš ì¹´ë“œ (with data) -->
                <div class="quick-action-card" data-target-tab="gantt-chart" style="cursor: pointer;">
                    <div class="card-icon">ğŸ“…</div>
                    <h3>ê³µì •ê³„íš í™•ì¸</h3>
                    <div style="font-size: 16px; color: #4CAF50; margin: 10px 0;">
                        <span id="dashboard-start-date">-</span> ~ <span id="dashboard-end-date">-</span>
                    </div>
                    <div style="font-size: 20px; font-weight: bold; color: #4CAF50; margin: 5px 0;">
                        <span id="dashboard-total-days">-</span> ì¼
                    </div>
                    <p style="margin: 5px 0; color: #666; font-size: 14px;">ì´ ê³µê¸°</p>
                </div>

                <!-- ê³µì •ì‹œë®¬ë ˆì´ì…˜ ì¹´ë“œ (button only) -->
                <div class="quick-action-card" data-target-tab="schedule-simulation" style="cursor: pointer;">
                    <div class="card-icon">ğŸ¬</div>
                    <h3>ê³µì • ì‹œë®¬ë ˆì´ì…˜</h3>
                    <p>4D ì‹œë®¬ë ˆì´ì…˜ ì‹¤í–‰</p>
                </div>

                <!-- AIê¸°ë°˜ ê°œì‚°ê²¬ì  ì¹´ë“œ (button only) -->
                <div class="quick-action-card" data-target-tab="schematic-estimation-sd" style="cursor: pointer;">
                    <div class="card-icon">ğŸ¤–</div>
                    <h3>AIê¸°ë°˜ ê°œì‚°ê²¬ì </h3>
                    <p>AI ëª¨ë¸ë¡œ ë¹ ë¥¸ ê²¬ì </p>
                </div>
            </div>
        </div>

        <!-- í”„ë¡œì íŠ¸ ë¯¸ì„ íƒ ì‹œ ì•ˆë‚´ -->
        <div id="home-no-project-message" style="background: white; border-radius: 8px; padding: 60px 25px; text-align: center; color: #999;">
            <div style="font-size: 48px; margin-bottom: 20px;">ğŸ“‚</div>
            <h3 style="color: #666; margin-bottom: 10px;">í”„ë¡œì íŠ¸ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”</h3>
            <p style="color: #999;">ì™¼ìª½ì—ì„œ í”„ë¡œì íŠ¸ë¥¼ ì„ íƒí•˜ê±°ë‚˜ ìƒˆë¡œ ìƒì„±í•˜ë©´<br>ëŒ€ì‹œë³´ë“œê°€ í‘œì‹œë©ë‹ˆë‹¤.</p>
        </div>
    </div>
</div>
```

---

### 2. ëŒ€ì‹œë³´ë“œ API ì—”ë“œí¬ì¸íŠ¸ ìƒì„±
**íŒŒì¼**: `connections/views.py`
**ìœ„ì¹˜**: Lines 7241-7313

**ê¸°ëŠ¥**:
1. **ì´ ê³µì‚¬ë¹„ ê³„ì‚°**: CostItem í…Œì´ë¸”ì—ì„œ total_price í•©ì‚°
2. **ê³µì • ê¸°ê°„ ê³„ì‚°**: Activity í…Œì´ë¸”ì—ì„œ ìµœì†Œ start_date ~ ìµœëŒ€ end_date ì¶”ì¶œ
3. **ì´ ê³µê¸° ê³„ì‚°**: (end_date - start_date).days + 1

**êµ¬í˜„ ì½”ë“œ**:
```python
@csrf_exempt
def home_dashboard_api(request, project_id):
    """
    í™ˆ ëŒ€ì‹œë³´ë“œ ë°ì´í„° ì œê³µ

    ë°˜í™˜ ë°ì´í„°:
    - total_cost: ì´ ê³µì‚¬ë¹„ (Decimal)
    - total_cost_formatted: ì²œ ë‹¨ìœ„ ì½¤ë§ˆ í¬í•¨ ë¬¸ìì—´ (ì˜ˆ: "1,234,567")
    - schedule:
        - start_date: ê³µì • ì‹œì‘ì¼ (YYYY-MM-DD)
        - end_date: ê³µì • ì¢…ë£Œì¼ (YYYY-MM-DD)
        - total_days: ì´ ê³µê¸° (ì¼ìˆ˜)
    """
    from decimal import Decimal
    import json

    try:
        project = Project.objects.get(id=project_id)
    except Project.DoesNotExist:
        return JsonResponse({'success': False, 'error': 'Project not found'}, status=404)

    # 1. ì´ ê³µì‚¬ë¹„ ê³„ì‚° (CostItem.total_price í•©ì‚°)
    cost_items = CostItem.objects.filter(project=project)
    total_cost = Decimal('0')

    for ci in cost_items:
        if ci.total_price:
            total_cost += Decimal(str(ci.total_price))

    # 2. ê³µì • ê¸°ê°„ ê³„ì‚° (Activity í…Œì´ë¸”ì—ì„œ min/max ë‚ ì§œ ì¶”ì¶œ)
    activities = Activity.objects.filter(project=project)
    start_date = None
    end_date = None

    for activity in activities:
        if activity.start_date:
            if not start_date or activity.start_date < start_date:
                start_date = activity.start_date
        if activity.end_date:
            if not end_date or activity.end_date > end_date:
                end_date = activity.end_date

    # 3. ì´ ê³µê¸° ê³„ì‚°
    total_days = 0
    if start_date and end_date:
        total_days = (end_date - start_date).days + 1  # +1 to include start date

    # 4. ì‘ë‹µ ë°ì´í„° êµ¬ì„±
    return JsonResponse({
        'success': True,
        'data': {
            'total_cost': float(total_cost),
            'total_cost_formatted': f"{total_cost:,.0f}" if total_cost > 0 else "-",
            'schedule': {
                'start_date': start_date.strftime('%Y-%m-%d') if start_date else None,
                'end_date': end_date.strftime('%Y-%m-%d') if end_date else None,
                'total_days': total_days
            }
        }
    })
```

**API ì—”ë“œí¬ì¸íŠ¸**:
```
GET /connections/api/dashboard/<uuid:project_id>/
```

**ì‘ë‹µ ì˜ˆì‹œ**:
```json
{
    "success": true,
    "data": {
        "total_cost": 1234567890.0,
        "total_cost_formatted": "1,234,567,890",
        "schedule": {
            "start_date": "2025-01-01",
            "end_date": "2025-12-31",
            "total_days": 365
        }
    }
}
```

---

### 3. URL ë¼ìš°íŒ… ì¶”ê°€
**íŒŒì¼**: `connections/urls.py`
**ìœ„ì¹˜**: Lines 174-176

**ë³€ê²½ ì‚¬í•­**:
```python
# â–¼â–¼â–¼ [NEW] Home Dashboard API â–¼â–¼â–¼
path('api/dashboard/<uuid:project_id>/', views.home_dashboard_api, name='home_dashboard_api'),
# â–²â–²â–² [NEW] Home Dashboard API End â–²â–²â–²
```

---

### 4. JavaScript ë¡œì§ êµ¬í˜„
**íŒŒì¼**: `connections/static/connections/home_tab_handlers.js`
**ìœ„ì¹˜**: Lines 189-214 (ê¸°ì¡´ í•¨ìˆ˜ ìˆ˜ì •), Lines 517-633 (ì‹ ê·œ í•¨ìˆ˜ ì¶”ê°€)

#### 4.1. í”„ë¡œì íŠ¸ ì •ë³´ ì—…ë°ì´íŠ¸ í•¨ìˆ˜ ìˆ˜ì •
**ë³€ê²½ ì „**:
```javascript
function updateHomeCurrentProjectInfo() {
    // ... í”„ë¡œì íŠ¸ ì´ë¦„ í‘œì‹œë§Œ ...
}
```

**ë³€ê²½ í›„** (Lines 189-214):
```javascript
function updateHomeCurrentProjectInfo() {
    const currentProjectInfo = document.getElementById('home-current-project-info');
    const currentProjectName = document.getElementById('home-current-project-name');

    if (!currentProjectInfo || !currentProjectName) return;

    if (currentProjectId) {
        const projectSelector = document.getElementById('project-selector');
        const selectedOption = projectSelector?.options[projectSelector.selectedIndex];
        const projectName = selectedOption?.text || 'ì•Œ ìˆ˜ ì—†ìŒ';

        currentProjectName.textContent = projectName;
        currentProjectInfo.style.display = 'block';

        // â–¼â–¼â–¼ [NEW] ëŒ€ì‹œë³´ë“œ í‘œì‹œ ë° ë°ì´í„° ë¡œë“œ â–¼â–¼â–¼
        showHomeDashboard();
        loadHomeDashboardData(currentProjectId);
        // â–²â–²â–² [NEW] ì—¬ê¸°ê¹Œì§€ â–²â–²â–²
    } else {
        currentProjectInfo.style.display = 'none';

        // â–¼â–¼â–¼ [NEW] ëŒ€ì‹œë³´ë“œ ìˆ¨ê¸°ê¸° â–¼â–¼â–¼
        hideHomeDashboard();
        // â–²â–²â–² [NEW] ì—¬ê¸°ê¹Œì§€ â–²â–²â–²
    }
}
```

#### 4.2. ì‹ ê·œ í•¨ìˆ˜ ì¶”ê°€ (Lines 517-633)

**showHomeDashboard()**: ëŒ€ì‹œë³´ë“œ í‘œì‹œ
```javascript
function showHomeDashboard() {
    const dashboard = document.getElementById('home-dashboard');
    const noProjectMessage = document.getElementById('home-no-project-message');

    if (dashboard) dashboard.style.display = 'block';
    if (noProjectMessage) noProjectMessage.style.display = 'none';
}
```

**hideHomeDashboard()**: ëŒ€ì‹œë³´ë“œ ìˆ¨ê¸°ê¸°
```javascript
function hideHomeDashboard() {
    const dashboard = document.getElementById('home-dashboard');
    const noProjectMessage = document.getElementById('home-no-project-message');

    if (dashboard) dashboard.style.display = 'none';
    if (noProjectMessage) noProjectMessage.style.display = 'block';
}
```

**loadHomeDashboardData(projectId)**: API í˜¸ì¶œ ë° ë°ì´í„° ë¡œë“œ
```javascript
async function loadHomeDashboardData(projectId) {
    console.log('[Dashboard] Loading dashboard data for project:', projectId);

    try {
        const response = await fetch(`/connections/api/dashboard/${projectId}/`);
        const result = await response.json();

        if (result.success && result.data) {
            console.log('[Dashboard] Data loaded successfully:', result.data);
            updateDashboardUI(result.data);
        } else {
            console.error('[Dashboard] Failed to load data:', result.error);
            showToast('ëŒ€ì‹œë³´ë“œ ë°ì´í„° ë¡œë“œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
        }
    } catch (error) {
        console.error('[Dashboard] Error loading dashboard data:', error);
        showToast('ëŒ€ì‹œë³´ë“œ ë°ì´í„° ë¡œë“œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
    }
}
```

**updateDashboardUI(data)**: DOM ì—…ë°ì´íŠ¸
```javascript
function updateDashboardUI(data) {
    console.log('[Dashboard] Updating UI with data:', data);

    // 1. ì´ ê³µì‚¬ë¹„
    const totalCostElement = document.getElementById('dashboard-total-cost');
    if (totalCostElement) {
        if (data.total_cost > 0) {
            totalCostElement.textContent = data.total_cost_formatted + 'ì›';
        } else {
            totalCostElement.textContent = 'ë°ì´í„° ì—†ìŒ';
        }
    }

    // 2. ê³µì • ê¸°ê°„ - ì‹œì‘ì¼
    const startDateElement = document.getElementById('dashboard-start-date');
    if (startDateElement) {
        startDateElement.textContent = data.schedule.start_date || '-';
    }

    // 3. ê³µì • ê¸°ê°„ - ì¢…ë£Œì¼
    const endDateElement = document.getElementById('dashboard-end-date');
    if (endDateElement) {
        endDateElement.textContent = data.schedule.end_date || '-';
    }

    // 4. ì´ ê³µê¸°
    const totalDaysElement = document.getElementById('dashboard-total-days');
    if (totalDaysElement) {
        if (data.schedule.total_days > 0) {
            totalDaysElement.textContent = data.schedule.total_days.toLocaleString();
        } else {
            totalDaysElement.textContent = '-';
        }
    }
}
```

#### 4.3. Window ìŠ¤ì½”í”„ Export (Lines 621-633)
```javascript
// Export functions to window for global access
window.loadHomeProjectList = loadHomeProjectList;
window.updateHomeProjectListSelection = updateHomeProjectListSelection;
window.updateHomeCurrentProjectInfo = updateHomeCurrentProjectInfo;
window.enableHomeProjectButtons = enableHomeProjectButtons;
window.handleHomeCreateProject = handleHomeCreateProject;
window.handleHomeDeleteProject = handleHomeDeleteProject;
window.setupHomeTabListeners = setupHomeTabListeners;
window.navigateToTab = navigateToTab;

// â–¼â–¼â–¼ [NEW] ëŒ€ì‹œë³´ë“œ í•¨ìˆ˜ Export â–¼â–¼â–¼
window.showHomeDashboard = showHomeDashboard;
window.hideHomeDashboard = hideHomeDashboard;
window.loadHomeDashboardData = loadHomeDashboardData;
window.updateDashboardUI = updateDashboardUI;
// â–²â–²â–² [NEW] ì—¬ê¸°ê¹Œì§€ â–²â–²â–²
```

---

## ì‚¬ìš© íë¦„

### 1. í”„ë¡œì íŠ¸ ë¯¸ì„ íƒ ìƒíƒœ
1. í™ˆ íƒ­ ì§„ì…
2. ì™¼ìª½: í”„ë¡œì íŠ¸ ê´€ë¦¬ ì˜ì—­ í‘œì‹œ (Select ë“œë¡­ë‹¤ìš´, ë²„íŠ¼ë“¤)
3. ì˜¤ë¥¸ìª½: "í”„ë¡œì íŠ¸ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”" ì•ˆë‚´ ë©”ì‹œì§€ í‘œì‹œ

### 2. í”„ë¡œì íŠ¸ ì„ íƒ ì‹œ
1. ì‚¬ìš©ìê°€ ì™¼ìª½ Select ë“œë¡­ë‹¤ìš´ì—ì„œ í”„ë¡œì íŠ¸ ì„ íƒ
2. `updateHomeCurrentProjectInfo()` í˜¸ì¶œ
3. `showHomeDashboard()` ì‹¤í–‰ â†’ ëŒ€ì‹œë³´ë“œ í‘œì‹œ, ì•ˆë‚´ ë©”ì‹œì§€ ìˆ¨ê¹€
4. `loadHomeDashboardData(projectId)` ì‹¤í–‰ â†’ API í˜¸ì¶œ
5. API ì‘ë‹µ ìˆ˜ì‹  â†’ `updateDashboardUI(data)` ì‹¤í–‰
6. DOM ì—…ë°ì´íŠ¸:
   - ì´ ê³µì‚¬ë¹„: `#dashboard-total-cost` í…ìŠ¤íŠ¸ ë³€ê²½
   - ì‹œì‘ì¼: `#dashboard-start-date` í…ìŠ¤íŠ¸ ë³€ê²½
   - ì¢…ë£Œì¼: `#dashboard-end-date` í…ìŠ¤íŠ¸ ë³€ê²½
   - ì´ ê³µê¸°: `#dashboard-total-days` í…ìŠ¤íŠ¸ ë³€ê²½

### 3. ëŒ€ì‹œë³´ë“œ ì¹´ë“œ í´ë¦­
- ê° ì¹´ë“œì— `data-target-tab` ì†ì„± ì„¤ì •
- í´ë¦­ ì‹œ í•´ë‹¹ íƒ­ìœ¼ë¡œ ì´ë™
- ì˜ˆì‹œ:
  - ìƒì„¸ë‚´ì—­ì„œ ë³´ê¸° â†’ `detailed-estimation-dd` íƒ­
  - ê³µì •ê³„íš í™•ì¸ â†’ `gantt-chart` íƒ­
  - ê³µì • ì‹œë®¬ë ˆì´ì…˜ â†’ `schedule-simulation` íƒ­
  - AIê¸°ë°˜ ê°œì‚°ê²¬ì  â†’ `schematic-estimation-sd` íƒ­

---

## ê¸°ìˆ ì  ì„¸ë¶€ì‚¬í•­

### Decimal íƒ€ì… ì‚¬ìš© ì´ìœ 
ê¸ˆì•¡ ê³„ì‚° ì‹œ ë¶€ë™ì†Œìˆ˜ì  ì˜¤ì°¨ë¥¼ ë°©ì§€í•˜ê¸° ìœ„í•´ Pythonì˜ `Decimal` íƒ€ì… ì‚¬ìš©:
```python
from decimal import Decimal

total_cost = Decimal('0')
for ci in cost_items:
    if ci.total_price:
        total_cost += Decimal(str(ci.total_price))
```

### ë‚ ì§œ í˜•ì‹ í†µì¼
API ì‘ë‹µì—ì„œ ë‚ ì§œë¥¼ `YYYY-MM-DD` í˜•ì‹ ë¬¸ìì—´ë¡œ ë°˜í™˜:
```python
start_date.strftime('%Y-%m-%d')
```

### ì²œ ë‹¨ìœ„ ì½¤ë§ˆ í‘œì‹œ
Pythonì—ì„œ í¬ë§·íŒ…:
```python
f"{total_cost:,.0f}"  # 1234567890 â†’ "1,234,567,890"
```

JavaScriptì—ì„œë„ ì¶”ê°€ ì²˜ë¦¬ ê°€ëŠ¥:
```javascript
data.schedule.total_days.toLocaleString()  // 365 â†’ "365"
```

### ë°ì´í„° ì—†ìŒ ì²˜ë¦¬
ê° í•„ë“œë§ˆë‹¤ ë°ì´í„° ë¶€ì¬ ì‹œ ì²˜ë¦¬:
- ì´ ê³µì‚¬ë¹„ 0ì›: "ë°ì´í„° ì—†ìŒ" í‘œì‹œ
- ë‚ ì§œ ì—†ìŒ: "-" í‘œì‹œ
- ì´ ê³µê¸° 0ì¼: "-" í‘œì‹œ

ë°±ì—”ë“œì—ì„œë„ ì²˜ë¦¬:
```python
'total_cost_formatted': f"{total_cost:,.0f}" if total_cost > 0 else "-"
```

### 2-Column Grid ë ˆì´ì•„ì›ƒ
CSS Grid ì‚¬ìš©:
```css
display: grid;
grid-template-columns: 400px 1fr;
gap: 30px;
align-items: start;
```

- `400px`: ì™¼ìª½ í”„ë¡œì íŠ¸ ê´€ë¦¬ ì˜ì—­ ê³ ì • ë„ˆë¹„
- `1fr`: ì˜¤ë¥¸ìª½ ëŒ€ì‹œë³´ë“œ ì˜ì—­ ìœ ë™ì  (ë‚˜ë¨¸ì§€ ê³µê°„ ëª¨ë‘ ì°¨ì§€)
- `gap: 30px`: ë‘ ì»¬ëŸ¼ ê°„ ê°„ê²©
- `align-items: start`: ìƒë‹¨ ì •ë ¬

### ì¹´ë“œ 2x2 Grid
ëŒ€ì‹œë³´ë“œ ë‚´ë¶€ ì¹´ë“œ ë°°ì¹˜:
```css
display: grid;
grid-template-columns: repeat(2, 1fr);
gap: 20px;
```

---

## í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤

### ì‹œë‚˜ë¦¬ì˜¤ 1: í”„ë¡œì íŠ¸ ë¯¸ì„ íƒ ìƒíƒœ
1. ì„œë²„ ì‹¤í–‰ í›„ í™ˆ íƒ­ ì§„ì…
2. **ì˜ˆìƒ ê²°ê³¼**: ì™¼ìª½ì— í”„ë¡œì íŠ¸ ê´€ë¦¬ ì˜ì—­, ì˜¤ë¥¸ìª½ì— "í”„ë¡œì íŠ¸ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”" ì•ˆë‚´ ë©”ì‹œì§€
3. **ì‹¤ì œ ê²°ê³¼**: âœ… (í…ŒìŠ¤íŠ¸ í•„ìš”)

### ì‹œë‚˜ë¦¬ì˜¤ 2: í”„ë¡œì íŠ¸ ì„ íƒ (ë°ì´í„° ìˆìŒ)
1. í”„ë¡œì íŠ¸ ì„ íƒ (CostItem, Activity ë°ì´í„° ì¡´ì¬)
2. **ì˜ˆìƒ ê²°ê³¼**:
   - ì´ ê³µì‚¬ë¹„: "1,234,567,890ì›" í˜•ì‹ í‘œì‹œ
   - ê³µì • ê¸°ê°„: "2025-01-01 ~ 2025-12-31" í‘œì‹œ
   - ì´ ê³µê¸°: "365 ì¼" í‘œì‹œ
3. **ì‹¤ì œ ê²°ê³¼**: âœ… (í…ŒìŠ¤íŠ¸ í•„ìš”)

### ì‹œë‚˜ë¦¬ì˜¤ 3: í”„ë¡œì íŠ¸ ì„ íƒ (ë°ì´í„° ì—†ìŒ)
1. í”„ë¡œì íŠ¸ ì„ íƒ (CostItem, Activity ë°ì´í„° ì—†ìŒ)
2. **ì˜ˆìƒ ê²°ê³¼**:
   - ì´ ê³µì‚¬ë¹„: "ë°ì´í„° ì—†ìŒ"
   - ê³µì • ê¸°ê°„: "- ~ -"
   - ì´ ê³µê¸°: "- ì¼"
3. **ì‹¤ì œ ê²°ê³¼**: âœ… (í…ŒìŠ¤íŠ¸ í•„ìš”)

### ì‹œë‚˜ë¦¬ì˜¤ 4: ì¹´ë“œ í´ë¦­ìœ¼ë¡œ íƒ­ ì´ë™
1. "ìƒì„¸ë‚´ì—­ì„œ ë³´ê¸°" ì¹´ë“œ í´ë¦­
2. **ì˜ˆìƒ ê²°ê³¼**: `detailed-estimation-dd` íƒ­ìœ¼ë¡œ ì´ë™
3. **ì‹¤ì œ ê²°ê³¼**: âœ… (í…ŒìŠ¤íŠ¸ í•„ìš”)

---

## í–¥í›„ ê°œì„  ì‚¬í•­

### 1. ë” ë§ì€ í†µê³„ ì¹´ë“œ ì¶”ê°€
- ì§„í–‰ë¥  (ì™„ë£Œëœ CostItem ìˆ˜ / ì „ì²´ CostItem ìˆ˜)
- ìµœê·¼ ì—…ë°ì´íŠ¸ ë‚ ì§œ
- ëª¨ë¸ ê°ì²´ ìˆ˜ (RawElement ê°œìˆ˜)
- AI ëª¨ë¸ ê°œìˆ˜

### 2. ì°¨íŠ¸ ì‹œê°í™” ì¶”ê°€
- Chart.js ë˜ëŠ” D3.js ì‚¬ìš©
- ê³µì¢…ë³„ ê³µì‚¬ë¹„ ë¹„ìœ¨ (íŒŒì´ ì°¨íŠ¸)
- ì›”ë³„ ê³µì‚¬ë¹„ ë¶„í¬ (ë§‰ëŒ€ ê·¸ë˜í”„)
- ê³µì •ë³„ ì§„í–‰ ìƒí™© (Gantt ì°¨íŠ¸ ë¯¸ë‹ˆë²„ì „)

### 3. ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸
- WebSocketì„ í†µí•œ ì‹¤ì‹œê°„ ë°ì´í„° ê°±ì‹ 
- CostItem ìˆ˜ì • ì‹œ ëŒ€ì‹œë³´ë“œ ìë™ ì—…ë°ì´íŠ¸
- Activity ìˆ˜ì • ì‹œ ê³µì • ê¸°ê°„ ìë™ ì—…ë°ì´íŠ¸

### 4. í•„í„°ë§ ê¸°ëŠ¥
- íŠ¹ì • CostCodeë§Œ í¬í•¨í•œ ê³µì‚¬ë¹„ ê³„ì‚°
- íŠ¹ì • ê¸°ê°„ë§Œ í¬í•¨í•œ ê³µì • ë¶„ì„
- ê³µì¢…ë³„, ì¸µë³„ í†µê³„ í•„í„°ë§

### 5. Export ê¸°ëŠ¥
- ëŒ€ì‹œë³´ë“œ PDF ë‚´ë³´ë‚´ê¸°
- ëŒ€ì‹œë³´ë“œ ì´ë¯¸ì§€ ìº¡ì²˜
- Excel ë³´ê³ ì„œ ìƒì„±

---

## íŒŒì¼ ë³€ê²½ ëª©ë¡

### ìˆ˜ì •ëœ íŒŒì¼

1. **connections/templates/revit_control.html**
   - Lines 208-329: í™ˆ íƒ­ HTML êµ¬ì¡° ë³€ê²½
   - 2-column Grid ë ˆì´ì•„ì›ƒ ì ìš©
   - ëŒ€ì‹œë³´ë“œ ì¹´ë“œ 4ê°œ ì¶”ê°€ (2x2 Grid)
   - í”„ë¡œì íŠ¸ ë¯¸ì„ íƒ ì‹œ ì•ˆë‚´ ë©”ì‹œì§€ ì¶”ê°€

2. **connections/views.py**
   - Lines 7241-7313: `home_dashboard_api()` í•¨ìˆ˜ ì¶”ê°€
   - CostItem.total_price í•©ì‚° ë¡œì§
   - Activity.start_date, end_date Min/Max ì¶”ì¶œ ë¡œì§
   - JSON ì‘ë‹µ í¬ë§·íŒ…

3. **connections/urls.py**
   - Lines 174-176: ëŒ€ì‹œë³´ë“œ API URL íŒ¨í„´ ì¶”ê°€
   - `api/dashboard/<uuid:project_id>/`

4. **connections/static/connections/home_tab_handlers.js**
   - Lines 189-214: `updateHomeCurrentProjectInfo()` í•¨ìˆ˜ ìˆ˜ì •
   - Lines 517-633: ì‹ ê·œ í•¨ìˆ˜ 4ê°œ ì¶”ê°€
     - `showHomeDashboard()`
     - `hideHomeDashboard()`
     - `loadHomeDashboardData(projectId)`
     - `updateDashboardUI(data)`
   - Window ìŠ¤ì½”í”„ Export ì¶”ê°€

---

## ê´€ë ¨ ë¬¸ì„œ

- ì´ì „ ì‘ì—…: `80_2025-11-05_AI_ë‹¨ë©´ìƒì_ëª…ë ¹_êµ¬í˜„.md`
- ê´€ë ¨ ê°€ì´ë“œë¼ì¸: `CLAUDE.md` â†’ "Frontend Architecture" ì„¹ì…˜
- ê´€ë ¨ ëª¨ë¸: `connections/models.py` â†’ `CostItem`, `Activity`, `Project`

---

## ì»¤ë°‹ ë©”ì‹œì§€

```
Implement Home tab dashboard with project statistics

- Convert Home tab to 2-column layout (400px project management + 1fr dashboard)
- Add dashboard cards showing real-time project data:
  - Total construction cost from CostItem.total_price aggregation
  - Schedule dates (start ~ end) and total days from Activity dates
  - Quick action buttons for simulation and AI estimation
- Create new API endpoint /api/dashboard/<project_id>/
  - Calculate total cost using Decimal for precision
  - Find min/max dates across all project activities
  - Return formatted data (comma-separated numbers, date strings)
- Implement dashboard visibility control in home_tab_handlers.js:
  - showHomeDashboard() / hideHomeDashboard()
  - loadHomeDashboardData() with async fetch
  - updateDashboardUI() for DOM element updates
- Show placeholder message when no project selected
- All new functions exported to window scope for global access

User can now see project overview at a glance on Home tab.

ğŸ¤– Generated with [Claude Code](https://claude.com/claude-code)

Co-Authored-By: Claude <noreply@anthropic.com>
```
